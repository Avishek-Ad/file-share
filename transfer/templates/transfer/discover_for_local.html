{% extends "transfer/base.html" %}
{% load static %}


{% block head_title %}
    Local Network
{% endblock %}

{% block content %}

<div class="relative min-h-screen flex flex-col items-center justify-center bg-slate-900 text-slate-200 overflow-hidden font-sans">

    <div class="absolute inset-0 z-0 overflow-hidden pointer-events-none">
    <div class="absolute inset-0 opacity-[0.05]" 
         style="background-image: linear-gradient(#fff 1px, transparent 1px), linear-gradient(90deg, #fff 1px, transparent 1px); background-size: 50px 50px;">
    </div>

    <div class="absolute top-1/4 -left-20 w-96 h-96 bg-primary/10 rounded-full blur-[120px] animate-pulse"></div>
    <div class="absolute bottom-1/4 -right-20 w-96 h-96 bg-secondary/10 rounded-full blur-[120px] animate-pulse delay-1000"></div>

    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10 brightness-100 contrast-150"></div>
    </div>

    <div class="absolute inset-0 flex items-center justify-center pointer-events-none z-0 opacity-10">
        <div class="w-125 h-125 border border-white/5 rounded-full animate-ping opacity-20" style="animation-duration: 4s;"></div>
        <div class="absolute w-75 h-75 border border-white/10 rounded-full"></div>
    </div>

    <div class="relative z-10 w-full max-w-md px-4 py-8 flex flex-col gap-8">

        <div class="text-center space-y-3">
            <h1 class="text-4xl font-black tracking-tighter uppercase italic text-white drop-shadow-md">
                P2P Transfer
            </h1>
            <div class="flex flex-col items-center gap-1">
                <div class="badge badge-primary badge-outline font-mono font-bold tracking-widest gap-2 py-3">
                    <span class="relative flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"></span>
                    </span>
                    Local Network
                </div>
                <p class="text-[10px] uppercase tracking-[0.2em] text-slate-500 font-bold mt-2">
                    Scanning for active nodes...
                </p>
            </div>
        </div>

        <div class="card bg-slate-800/40 backdrop-blur-xl border border-white/5 shadow-2xl">
            <div class="card-body p-6">
                <div class="flex items-center justify-between border-b border-white/5 pb-4 mb-2">
                    <h2 class="text-xs font-bold uppercase tracking-widest text-slate-400" id="sub-title"></h2>
                    <span class="loading loading-dots loading-xs text-primary"></span>
                </div>

                <ul id="all-users" class="flex flex-col gap-2 max-h-60 overflow-y-auto custom-scrollbar">
                    </ul>
            </div>
        </div>

        <div id="container" class="hidden card bg-slate-800/80 backdrop-blur-2xl border border-primary/20 shadow-[0_0_40px_rgba(0,0,0,0.3)] animate-in fade-in zoom-in duration-300">
            <div class="card-body p-6 gap-5">
                <div class="flex flex-col gap-1">
                    <span class="text-[10px] font-bold uppercase tracking-widest text-primary/80">
                        Target Node
                        <span id="receiver-cancled-text" class="hidden badge badge-error badge-xs pt-1 mx-5">Receiver Ignored</span>
                    </span>
                    <p id="container-title" class="text-2xl font-mono font-bold text-white"></p>
                </div>

                <div class="form-control">
                    <input
                        type="file"
                        id="file-choosen"
                        class="file-input file-input-bordered file-input-primary file-input-sm w-full bg-slate-900/50"
                        accept="*/*"
                    />
                    <label class="label">
                        <span class="label-text-alt text-slate-500 italic">Max suggested: 100MB</span>
                    </label>
                </div>

                <div class="card-actions justify-end gap-2">
                    <button id="hide-container-button" class="btn btn-ghost btn-sm text-slate-400 hover:text-white">
                        Cancel
                    </button>
                    <button id="send-file-button" class="btn btn-primary btn-sm px-6 shadow-lg shadow-primary/20">
                        Initiate Transfer
                    </button>
                </div>
            </div>
        </div>

        <div id="confirm-or-deny" class="hidden card bg-slate-800/90 backdrop-blur-2xl border border-secondary/30 shadow-[0_0_50px_rgba(0,0,0,0.4)] animate-in slide-in-from-bottom-4 duration-300">
            <div class="card-body p-6 gap-6">
                <div class="flex items-center gap-4">
                    <div class="p-3 bg-secondary/10 rounded-xl">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-secondary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                    </div>
                    <div>
                        <h3 class="card-title text-white leading-tight">Incoming Data</h3>
                        <p class="text-xs text-slate-400">Node <span class="font-mono text-secondary font-bold" id="sender-id-show"></span> is requesting a tunnel.</p>
                    </div>
                </div>

                <div class="flex justify-end gap-2">
                    <button id="receive-cancel-button" class="btn btn-ghost btn-sm text-error">
                        Ignore
                    </button>
                    <button id="receive-accept-button" class="btn btn-success btn-sm px-8 text-white">
                        Accept
                    </button>
                </div>
            </div>
        </div>

    </div>
</div>

<style>
    .custom-scrollbar::-webkit-scrollbar { width: 4px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #475569; }
</style>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="{% static 'js/main_for_local.js' %}"></script>

{% endblock %}